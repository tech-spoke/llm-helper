# v1.2 Update / v1.2 アップデート

Release Date: 2025-01

## Summary / 概要

v1.2 adds OverlayFS-based garbage detection and gate level controls for exploration phases.

v1.2 では OverlayFS によるガベージ検出と、探索フェーズの厳格さを制御する gate level を追加。

## New Features / 新機能

### OverlayFS Garbage Detection

Captures all file changes during implementation and allows review before commit.

**Workflow:**
1. `start_session` with `enable_overlay: true` creates task branch
2. OverlayFS captures all changes in upper directory
3. `review_changes` shows diff of all modifications
4. `finalize_changes` allows keep/discard decisions per file
5. Clean commit with only intended changes

**Usage:**
```
mcp__code-intel__start_session
  intent: "IMPLEMENT"
  query: "Add feature"
  enable_overlay: true  # Enable garbage detection
```

**Requirements:**
- `fuse-overlayfs` installed
- Git repository initialized

### Gate Level Controls

Control the strictness of exploration phase requirements.

| Level | Description |
|-------|-------------|
| `high` | Strict requirements (default) |
| `middle` | Standard requirements |
| `low` | Relaxed requirements |
| `auto` | Server determines based on risk |
| `none` | Skip exploration, go directly to READY |

**Usage:**
```
/code -g=m add validation   # middle gate
/code -q fix typo           # quick mode (= -g=n)
```

### New Phases

| Phase | Description |
|-------|-------------|
| PRE_COMMIT | Review changes before commit (if overlay enabled) |
| Finalize | Commit and optionally merge to main |

### Cleanup Command

Clean up stale overlays from interrupted sessions:
```
/code --clean
```

## Command Options / コマンドオプション

| Long | Short | Description |
|------|-------|-------------|
| `--gate=LEVEL` | `-g=LEVEL` | Set gate level |
| `--quick` | `-q` | Skip exploration (= `-g=n`) |
| `--clean` | `-c` | Cleanup stale overlays |
| `--rebuild` | `-r` | Force full re-index |

## Bug Fixes / バグ修正

- None
